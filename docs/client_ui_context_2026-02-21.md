# Клиентский веб-интерфейс: зафиксированный контекст

Дата фиксации: 2026-02-21
Статус: рабочий драфт требований (на основе Q/A-сессии)
Точка продолжения: следующий вопрос = #237

## 1) Продуктовая модель клиента

- Клиент работает только с проверенным каталогом сервисов.
- Добавление URL клиентом отсутствует: сервисы заводит только админ.
- Подключение сервиса клиентом: по одному (`Подключить`).
- Расписание проверок фиксированное: 1 раз в сутки.
- Доступ клиента: приватный кабинет (без публичных страниц).
- Командный доступ отсутствует: 1 пользователь = 1 аккаунт.

## 2) Навигация и разделы

- Разделы v1: `Дашборд`, `Каталог`, `Мои сервисы`, `Изменения`, `Тариф/Биллинг`, `Профиль`.
- Desktop: sidebar.
- Mobile: нижний tab-bar = `Каталог`, `Мои`, `Изменения`, `Биллинг`.
- На mobile `Дашборд` и `Профиль` открываются через `Еще`.
- После логина: переход на `Дашборд`.

## 3) Тарифы и лимиты

- Лимиты показываются одновременно: общий + по тематикам.
- При достижении лимитов: блокировка действия + апселл.
- Тарифы:
  - Free: лимиты по тематикам, ограничения на фичи.
  - Paid 30: общий лимит 30 URL.
  - Paid 100: общий лимит 100 URL.
- Клиент удаляет сервисы (без режима pause).
- Удаление мгновенное; слот лимита освобождается сразу.
- Повторное подключение после удаления — сразу (без cooldown).

## 4) Ограничения и доступ по тарифам

- `FAILED` события на Free не показываются.
- KPI `FAILED` на Free скрыт.
- История версий (до 50) доступна только на платных.
- Для Free: доступны diff-события, но без просмотра версий документов.
- Diff (подсветка удалено/добавлено) доступен всем тарифам.
- Ограничения Free в UI явно не акцентируются отдельными paywall-лейблами.

## 5) Каталог

- Показываем весь каталог, недоступные помечаются логикой paywall по действию.
- Поиск: по названию и домену.
- Сортировок в v1 нет.
- Social proof: диапазоны (например, `100+`), показываем всем.
- Отзывы/рейтинги: нет.
- Карточки одинаковой высоты.
- Есть внешняя ссылка `Открыть источник` в новой вкладке.
- Отдельной страницы каталожного сервиса нет (только карточка).
- Навигация списка: infinite scroll.
- Desktop: sticky фильтры/поиск.
- Mobile: фильтры через кнопку и bottom sheet.
- Mobile filters: `Применить` + `Сбросить`.
- Для лимитных сервисов кнопка `Подключить` активна, при клике открывается paywall.

## 6) Рекомендации

- Есть блок `Рекомендовано для вас`.
- Показываем 10 карточек.
- Если не хватает по тематике: добиваем популярными.
- Ранжирование: сначала совпадение тематики, внутри — популярность.
- Onboarding-попап тематики: опциональный, закрываемый.

## 7) Дашборд

- KPI за 24ч: подключено, CHANGED, FAILED, лимиты (с учетом тарифных правил).
- На Free KPI FAILED скрыт.
- Есть блок `Последние изменения` на 5 событий.
- Клик по событию в мини-ленте ведет в `Изменения`.
- Индикатор `последнее обновление` только на дашборде.
- Формат времени: абсолютное + относительное.

## 8) Мои сервисы

- Виды: переключатель таблица/карточки.
- По умолчанию: карточки.
- Primary на карточке: `Подробнее`.
- Удаление внутри деталей сервиса (danger zone внизу).
- Отдельная страница деталей сервиса есть.
- В деталях: базовая инфо + последние 10 изменений.
- Кнопки `Смотреть все изменения` в деталях нет.
- Блока `Похожие сервисы` нет.

## 9) Изменения

- История: вся доступная, с пагинацией.
- Страница по умолчанию: 20, переключатель 20/50/100.
- Фильтры (v1): период + сервис.
- Поиск есть (название/домен).
- Сортировка по умолчанию: новые сверху.
- Бейдж уровня (`NOISE/MINOR/MAJOR`) показываем всегда.
- Цветовой код уровней не используем (только текст).
- На desktop и mobile — карточки.
- Модалка diff открывается из списка.
- Desktop: в модалке next/prev есть.
- Mobile: закрытие по крестику + свайп вниз.
- Deep-link для открытия конкретной модалки diff в v1 нет.
- Пустая выдача по фильтрам: CTA `Сбросить фильтры`.
- Счетчик `Найдено N` не показываем.
- Максимум ручного периода за запрос: 90 дней; при превышении блокируем выбор в UI.

## 10) Уведомления

- Каналы: email + Telegram.
- Управляет клиент в профиле.
- События: только `CHANGED`.
- Формат: ежедневный дайджест, не instant.
- Дайджест: плоский список событий.
- Если изменений нет, письмо не отправляется.
- Время дайджеста: 09:00 по timezone профиля.
- Дни отправки: каждый день.
- В дайджест попадают только текущие подключенные сервисы.
- Для Telegram:
  - подключение через бот + одноразовый код;
  - если не подключен — блокирующий flow перед включением;
  - при отвязке все Telegram-переключатели сбрасываются;
  - в профиле виден полный статус связки + `Отвязать`.
- Переключатели типов уведомлений:
  - Email: `Дайджест` + `Маркетинг/новости`.
  - Telegram: `Дайджест` + `Системные`.

## 11) Аутентификация и аккаунт

- Регистрация: self-signup email+password + подтверждение email.
- Google login: включен.
- Google auto-signup: включен.
- Если email из Google неподтвержден: нужен наш verify flow.
- Связка Google с существующим email-аккаунтом: автоматическая.
- Язык по умолчанию (email и Google): `ru`.
- Пароль: минимум 8 символов, буква + цифра.
- Ротации пароля по сроку нет.
- Forgot password: есть, после смены пароля logout всех сессий.
- Срок сессии: 90 дней, без idle-timeout.
- `Запомнить меня`: отключено (не используется).
- Критические действия требуют подтверждения (пароль/re-auth).
- Для Google-only критические действия подтверждаются re-auth Google.

## 12) Профиль и настройки

- Язык: RU/EN.
- Переключатель языка в `Профиль` (не в глобальной шапке).
- Время: настройка `локальное/UTC` + дефолт `Europe/Moscow`.
- Публичные персональные поля (имя/компания) в v1 не редактируются.
- API keys в v1 нет.
- `Сессии и устройства` в v1 нет.
- Dark mode нет, плотность интерфейса фиксированная.
- Профильные разделы — отдельные страницы.
- Вход в профильные разделы: через единый пункт `Профиль`.

## 13) Биллинг

- В v1 в кабинете есть биллинг + история платежей/документы.
- Месячный и годовой циклы.
- Смена тарифа:
  - upgrade: сразу с proration;
  - downgrade: со следующего периода.
- При downgrade сверх лимита: автоотключение лишних + предупреждение.
- Правило автоотключения: LIFO.
- Доп. правило: сначала отключаем архивные, потом LIFO по активным.
- Уведомление об автоотключении: история аккаунта + email/Telegram.
- В уведомлении CTA: `Повысить тариф` -> `Тариф/Биллинг` с предвыбором.
- Сравнение тарифов: таблица (10+ строк), mobile часть строк под `Подробнее`.
- Валюта: RUB.
- Цены: “включая НДС”.

### Платежи на первом этапе

- До YooKassa: только `Тестовый баланс`.
- При нехватке баланса: ошибка + CTA `Пополнить у админа`.
- Баланс показывается и в шапке, и в `Тариф/Биллинг`.
- Алерт низкого баланса: нет.
- При неуспешном списании автопродления: сразу перевод в Free.
- После автоперехода в Free: persistent баннер на `Дашборд` и `Тариф/Биллинг`.
- `Восстановить тариф`: открытие биллинга с предвыбранным прежним тарифом.
- После восстановления тарифа ранее отключенные сервисы автоматически не возвращаем; пользователь идет в каталог.
- После оплаты показываем одноразовый информер с CTA `Открыть каталог`.

## 14) Email verify / lifecycle

- До подтверждения email: доступ только в рамках Free (с подключениями по free-лимитам).
- Покупка тарифа до verify запрещена.
- При попытке покупки без verify: блок + CTA `Подтвердить email`.
- Повтор verify email: не чаще 60 сек, лимит 10/сутки.
- TTL verify ссылки: 48 часов.
- Просроченная ссылка: экран + `Отправить снова`.

## 15) Удаление аккаунта

- Self-service удаление включено.
- Soft delete: 30 дней, затем hard delete.
- В период soft delete вход блокируется обычным доступом и показывается экран восстановления.
- На экране: дата удаления + кнопка `Восстановить аккаунт`.
- Восстановление: в 1 клик (без доп. шага).
- На старте soft delete отправляется подтверждающее письмо.
- Привязки сервисов держим 30 дней и при восстановлении возвращаем полностью.
- Если прежний тариф архивирован: переводим в Free.

## 16) Поддержка и информирование

- Раздел `Поддержка` есть.
- Формы обращений нет.
- В `Поддержка`: контакты email + Telegram + FAQ-блок.
- Глобальный админ-баннер в шапке есть; пользователь скрыть не может.

## 17) Важные корректировки в ходе сессии

- #46 изменен на вариант 1 (desktop sidebar + mobile bottom nav).
- #112 изменен на вариант 1 (покупка только после verify email).
- #165 изменен на вариант 2 (без `Запомнить меня`).
- #220 изменен на вариант 2 (без мастера восстановления сервисов).
- #224 подтвержден вариант 3 (paywall при клике `Подключить` на лимитном сервисе).
- #228 скорректирован на вариант 1 (inline retry).
- #229 подтвержден вариант 2 (использовать backend текст ошибки).

## 18) Нерешенное / next

- Последний обработанный номер: #236 (`Интеграции` как отдельный раздел).
- Следующий вопрос для продолжения: #237.

