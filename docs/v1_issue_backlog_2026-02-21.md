# V1 Issue-Ready Backlog

Дата: 2026-02-21  
База: `docs/v1_sprint_execution_plan_2026-02-21.md`

Формат задач:
- `Priority`: P0 (критично для релиза), P1 (важно для релиза), P2 (можно после RC).
- `Depends on`: ключевые зависимости.
- `Acceptance`: критерии приемки для закрытия задачи.

## EPIC E1: Notification Settings Core

### E1-01 Backend: модель настроек уведомлений

- Priority: P0
- Что сделать: реализовать хранение и чтение настроек каналов (email digest, telegram digest, маркетинг, системные), статусы канала и метаданные ошибок.
- Depends on: нет
- Acceptance:
- API возвращает текущие настройки и статусы каналов.
- Для невалидных данных возвращается корректная ошибка валидации.
- Unit-тесты покрывают базовые сценарии create/update/read.

### E1-02 Backend: ограничения verify email

- Priority: P0
- Что сделать: запретить включение email-дайджеста без подтвержденного email; добавить reason code для UI.
- Depends on: E1-01
- Acceptance:
- При `email_verified=false` включение email-дайджеста отклоняется.
- API возвращает причину, пригодную для inline-подсказки.
- Поведение покрыто unit/integration тестами.

### E1-03 Frontend: экран `Профиль -> Уведомления` (каркас)

- Priority: P0
- Что сделать: отрисовать секцию каналов, статусы, тумблеры, блок ошибок и кнопку `Сохранить`.
- Depends on: E1-01
- Acceptance:
- Экран доступен на desktop/mobile.
- Текущее состояние подгружается из API.
- Кнопка `Сохранить` активируется только при изменениях.

### E1-04 Frontend: сохранение настроек + обработка ошибок

- Priority: P0
- Что сделать: подключить submit настроек, блокировку контролов на время сохранения, inline-ошибку + `Повторить`.
- Depends on: E1-03
- Acceptance:
- При submit контролы временно блокируются.
- При ошибке видно inline-сообщение и кнопка `Повторить`.
- Успешное сохранение отображает состояние `Сохранено`.

### E1-05 Frontend: resend verify email из уведомлений

- Priority: P1
- Что сделать: добавить action `Отправить письмо снова` с учетом rate-limit.
- Depends on: E1-02, E1-03
- Acceptance:
- Кнопка видна только в релевантном состоянии.
- При превышении лимита пользователь получает корректное сообщение.
- Поведение протестировано на mobile/desktop.

## EPIC E2: Telegram Integration v1

### E2-01 Backend: link/unlink Telegram

- Priority: P0
- Что сделать: реализовать API привязки/отвязки Telegram через одноразовый код и хранение статуса связки.
- Depends on: E1-01
- Acceptance:
- Успешная привязка меняет статус на connected.
- Отвязка сбрасывает Telegram-переключатели.
- Интеграционные тесты проходят.

### E2-02 Backend: test-send Telegram + rate-limit

- Priority: P0
- Что сделать: endpoint тестовой отправки Telegram (`1/60 сек`, `20/сутки`).
- Depends on: E2-01
- Acceptance:
- Сообщение отправляется при валидной связке.
- Ограничения частоты применяются корректно.
- Ошибки лимитов возвращаются явным кодом.

### E2-03 Backend: обработка `telegram disconnected`

- Priority: P0
- Что сделать: при потере связки автоматически отключать Telegram-дайджест и отдавать причину.
- Depends on: E2-01
- Acceptance:
- При событии disconnect тумблеры сброшены на backend.
- UI получает статус и причину для отображения.
- Сценарий покрыт интеграционным тестом.

### E2-04 Frontend: Telegram controls в `Уведомлениях`

- Priority: P0
- Что сделать: кнопки `Подключить/Отвязать`, `Отправить тест`, статус канала, обработка disconnected.
- Depends on: E2-01, E2-02, E2-03, E1-03
- Acceptance:
- Полный пользовательский flow link/test/unlink работает.
- При disconnected отображается ошибка + CTA `Переподключить`.
- Поведение соответствует ограничениям тарифа.

## EPIC E3: Billing Limits + Paywall UX

### E3-01 Frontend: унифицированный paywall inline-block

- Priority: P0
- Что сделать: внедрить единый UI-паттерн “нет доступа по тарифу” для каталога/настроек и других точек.
- Depends on: нет
- Acceptance:
- Один компонент используется во всех целевых местах.
- Есть CTA в `Тариф/Биллинг`.
- Нет дублирующихся самописных вариантов.

### E3-02 Frontend: экран `403 доступ ограничен тарифом`

- Priority: P1
- Что сделать: реализовать отдельный экран с понятным текстом и CTA.
- Depends on: E3-01
- Acceptance:
- Роут корректно отрабатывает restricted access.
- Экран доступен на mobile/desktop.

### E3-03 QA: сценарии Free/Paid лимитов

- Priority: P0
- Что сделать: прогнать матрицу ограничений (подключения, уведомления, скрытые/доступные элементы).
- Depends on: E3-01, E1-04, E2-04
- Acceptance:
- Все ключевые сценарии оформлены тест-кейсами.
- Нет незакрытых P0 дефектов по лимитам.

## EPIC E4: Dashboard and My Services

### E4-01 Frontend: Dashboard KPI + CTA

- Priority: P1
- Что сделать: KPI-блок, `Последние изменения`, CTA `Включить уведомления` при выключенных каналах.
- Depends on: E1-03
- Acceptance:
- KPI и лента отображаются корректно.
- CTA видна только в целевом состоянии.

### E4-02 Frontend: onboarding-чеклист на Dashboard

- Priority: P2
- Что сделать: компактный скрываемый чеклист.
- Depends on: E4-01
- Acceptance:
- Показывается по условиям.
- Можно скрыть, не блокирует работу.

### E4-03 Frontend: `Мои сервисы` (поиск + карточка)

- Priority: P1
- Что сделать: поиск по домену/названию, порядок по дате подключения, поля карточки (дата, источник, последнее изменение).
- Depends on: нет
- Acceptance:
- Поиск работает по двум полям.
- Дефолтный порядок соответствует решению.
- Поля карточки соответствуют спецификации.

### E4-04 Frontend: удаление сервиса через confirm-модалку

- Priority: P1
- Что сделать: единая confirm-модалка и финальное удаление без undo.
- Depends on: E4-03
- Acceptance:
- Без подтверждения удаление не выполняется.
- После подтверждения сервис удален и UI обновлен.

## EPIC E5: Changes Feed v1

### E5-01 Frontend: список `Изменения` + фильтры период/сервис

- Priority: P1
- Что сделать: карточки изменений, пагинация и фильтры (без `change_level` фильтра).
- Depends on: нет
- Acceptance:
- Список грузится и фильтруется по period/service.
- Сортировка “новые сверху” соблюдена.
- Фильтр `change_level` отсутствует.

### E5-02 Frontend: empty-state + CTA `Сбросить фильтры`

- Priority: P1
- Что сделать: отдельный empty-state для пустой выборки.
- Depends on: E5-01
- Acceptance:
- При пустом результате отображается CTA.
- CTA сбрасывает фильтры и перезагружает список.

## EPIC E6: Auth/Security Lifecycle

### E6-01 Backend: logout всех сессий при смене пароля

- Priority: P0
- Что сделать: после смены пароля инвалидировать все активные сессии.
- Depends on: нет
- Acceptance:
- Старые токены/сессии становятся невалидными.
- Сценарий покрыт тестом.

### E6-02 Backend+Frontend: soft-delete lifecycle (30 дней)

- Priority: P0
- Что сделать: блок входа в период soft-delete, экран восстановления, восстановление в 1 клик.
- Depends on: нет
- Acceptance:
- В период soft-delete доступен только экран восстановления.
- Восстановление возвращает аккаунт в активное состояние.

### E6-03 Notifications: security emails

- Priority: P1
- Что сделать: отправка email при смене пароля и при смене email (на старый и новый адрес).
- Depends on: нет
- Acceptance:
- Оба сценария генерируют уведомления корректным получателям.
- Ошибки отправки логируются на сервере.

## EPIC E7: Error States and Reliability

### E7-01 Frontend: унифицированный `404`

- Priority: P1
- Что сделать: экран `404` с CTA `На дашборд`.
- Depends on: нет
- Acceptance:
- Ошибочные роуты переводят на `404`.
- CTA ведет на дашборд.

### E7-02 Frontend: унифицированный `500` + short error id

- Priority: P1
- Что сделать: экран системной ошибки с коротким ID для поддержки.
- Depends on: нет
- Acceptance:
- Экран показывает ID ошибки.
- Текст и CTA соответствуют дизайну.

### E7-03 QA: отказоустойчивость сохранения настроек

- Priority: P0
- Что сделать: тесты деградации API на `Профиль -> Уведомления`.
- Depends on: E1-04
- Acceptance:
- Проверены network error, timeout, backend 4xx/5xx.
- UI сохраняет предсказуемое поведение без потери состояния.

## EPIC E8: QA, Stabilization, Release

### E8-01 QA: full acceptance pass на staging

- Priority: P0
- Что сделать: полный прогон чеклиста из `docs/v1_scope_checklist_2026-02-21.md`.
- Depends on: E1..E7
- Acceptance:
- Все тест-кейсы пройдены.
- Открытых P0/P1 блокеров нет.

### E8-02 Release candidate freeze

- Priority: P0
- Что сделать: объявить freeze, закрыть только release-блокеры, подготовить RC.
- Depends on: E8-01
- Acceptance:
- RC собран и доступен для финального sign-off.
- Изменения вне scope не включены.

## Первая волна запуска (только P0)

Порядок выполнения:

1. `E1-01` Backend: модель настроек уведомлений.
2. `E1-02` Backend: ограничения verify email.
3. `E2-01` Backend: link/unlink Telegram.
4. `E2-02` Backend: test-send Telegram + rate-limit.
5. `E2-03` Backend: обработка `telegram disconnected`.
6. `E1-03` Frontend: каркас `Профиль -> Уведомления`.
7. `E1-04` Frontend: сохранение настроек + обработка ошибок.
8. `E2-04` Frontend: Telegram controls.
9. `E6-01` Backend: logout всех сессий при смене пароля.
10. `E6-02` Backend+Frontend: soft-delete lifecycle.
11. `E3-01` Frontend: унифицированный paywall inline-block.
12. `E3-03` QA: сценарии Free/Paid лимитов.
13. `E7-03` QA: отказоустойчивость сохранения настроек.
14. `E8-01` QA: full acceptance pass на staging.
15. `E8-02` Release candidate freeze.

Критерий готовности волны:

- Все задачи выше закрыты.
- Открытых `P0` дефектов нет.
- Можно переходить к `P1` задачам без пересмотра принятых продуктовых решений.
